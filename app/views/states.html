<div class="row">
	<div class="col-xs-12 col-md-4 col-lg-3">
		<page-filter sort-order="sortOrder" number-of-results="totalStates" amount-per-page="amountPerPage" current-page="currentPage" from="from" until="until" display-every="displayEvery" display-every-levels="displayEveryLevels" refresh="refreshSearch()"></page-filter>
	</div>

	<div class="col-xs-12 col-md-8 col-lg-9">
        <div class="nav-tabs-custom">
        	<ul class="nav nav-tabs">
        		<li ng-class="{'active' : tabId === activeDetailTab}" ng-repeat="(tabId, tabName) in detailTabs">
        			<a ng-click="$parent.activeDetailTab = tabId">{{tabName}}</a>
        		</li>
            </ul>
            <div class="tab-content" ng-switch="activeDetailTab">
            	<div ng-switch-when="socgraph" class="tab-pane active">
            		<div state-of-charge-graph states="states"></div>
              	</div>
            	<div ng-switch-when="energysourcegraph" class="tab-pane active">
                	<div energy-source-graph states="states" building="building" is-reverse-order="sortOrder === 'desc'"></div>
              	</div>
              	<div ng-switch-when="totalenergy" class="tab-pane active">
              		<div total-energy-graph states="states" building="building" is-reverse-order="sortOrder === 'desc'"></div>
              	</div>
            </div>
        </div>
    </div>

	<div class="col-xs-12">
		<div class="box" ng-if="building">
		  	<div class="box-header with-border">
		    	<h3 class="box-title">
		    		Results
		    		<small>{{states.length | number}} states<span ng-if="totalStates"> of {{totalStates | number}}</span></small>
		    	</h3>
		  	</div>
		  	<div class="box-body table-responsive no-padding">
			    <table class="table table-hover">
			    	<tbody>
				    	<tr>
				        	<th>Index</th>
				        	<th>Time</th>
				        	<th>State of Charge</th>
				        	<th>Current Charge Level</th>
				        	<th>Battery Capacity</th>
				        	<th>Current energy in since last 0%</th>
				        	<th>Current energy out since last 0%</th>
				        	<th>Previous energy in since last 0%</th>
				        	<th>Previous energy out since last 0%</th>
				        	<th>Charge Efficiency</th>
				        	<th>Voltage status</th>
				        	<th>Is charging</th>
				        	<th>Empty level established</th>
				        	<th>Hourly consumption</th>
				        	<th>Daily consumption</th>
				        	<th>Average consumption power</th>
				        	<th ng-repeat="energySourceName in energySources">{{energySourceName}} power</th>
				        	<th ng-repeat="energySourceName in energySources">{{energySourceName}} average power</th>
				        	<th ng-repeat="energySourceName in energySources">{{energySourceName}} hourly charge</th>
				        	<th ng-repeat="energySourceName in energySources">{{energySourceName}} daily charge</th>
				      	</tr>
				      	<!-- Each reading -->
				      	<tr ng-repeat="state in states">
				      		<td>{{(currentPage - 1) * amountPerPage + $index + 1}}</td>
				      		<td>{{state.timestamp | amFromUnix | amDateFormat:dateTimeFormat}}</td>
				      		<td>{{(state.currentChargeLevel / state.batteryCapacity * 100) | number:2}}%
				      		<td>{{state.currentChargeLevel | number:2}} Wh</td>
				      		<td>{{state.batteryCapacity | number:2}} Wh</td>
				      		<td>{{state.currentEnergyInSinceLastC0 | number:2}} Wh</td>
				      		<td>{{state.currentEnergyOutSinceLastC0 | number:2}} Wh</td>
				      		<td>{{state.previousEnergyInSinceLastC0 | number:2}} Wh</td>
				      		<td>{{state.previousEnergyOutSinceLastC0 | number:2}} Wh</td>
				      		<td>{{state.chargeEfficiency * 100 | number:2}}%</td>
				      		<td ng-if="state.batteryLevelLowSince">Low voltage since {{state.batteryLevelLowSince | amFromUnix | amDateFormat:dateTimeFormat}}</td>
				      		<td ng-if="!state.batteryLevelLowSince">Normal</td>
				      		<td>{{state.isBatteryCharging ? "Yes" : "No"}}</td>
				      		<td>{{state.emptyLevelEstablished ? "Yes" : "No"}}</td>
				      		<td>{{state.consumption.hourlyTotal | number:2}} Wh</td>
				      		<td>{{state.consumption.dailyTotal | number:2}} Wh</td>
				      		<td>{{state.consumption.averagePower | number:2}} Watts</td>
	 				      	<td ng-repeat="(energySourceId, energySourceName) in energySources">
				      			{{state.sources[energySourceId].power | number:2}} Watts
				      		</td>
				      		<td ng-repeat="(energySourceId, energySourceName) in energySources">
				      			{{state.sources[energySourceId].averagePower | number:2}} Watts
				      		</td>
				      		<td ng-repeat="(energySourceId, energySourceName) in energySources">
				      			{{state.sources[energySourceId].hourlyCharge | number:2}} Wh
				      		</td>
				      		<td ng-repeat="(energySourceId, energySourceName) in energySources">
				      			{{state.sources[energySourceId].dailyCharge | number:2}} Wh
				      		</td>
				      	</tr>
				    </tbody>
				</table>
			</div>
		</div>
	</div>
</div>